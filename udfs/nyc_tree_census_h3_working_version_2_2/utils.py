import pandas as pd

@fused.cache
def get_data():
    df = pd.read_csv("https://data.cityofnewyork.us/api/views/5rq2-4hqu/rows.csv?accessType=DOWNLOAD")
    df["latitude"] = df["Latitude"]
    df["name"] = df["spc_common"]
    return df
def get_con():
    import duckdb
    con = duckdb.connect(config={"allow_unsigned_extensions": True})
    con.sql(""" INSTALL h3ext FROM 'https://pub-cc26a6fd5d8240078bd0c2e0623393a5.r2.dev';
                LOAD h3ext;
                INSTALL spatial;
                LOAD spatial;
                INSTALL httpfs;
                LOAD httpfs;
               -- SET s3_region='us-west-2';""")
    return con
def add_rgb_cmap(gdf, key_field, cmap_dict):
    """
    Apply a colormap dictionary to a GeoDataFrame based on a specified key field.

    This function adds 'r', 'g', and 'b' columns to a GeoDataFrame, where the values
    are determined by a colormap dictionary based on the values in a specified key field.

    Args:
    gdf (GeoDataFrame): The GeoDataFrame to which the colormap will be applied.
    key_field (str): The column in the GeoDataFrame whose values will be used to look up the colormap.
    cmap_dict (dict): A dictionary mapping key_field values to RGB color lists.

    Returns:
    GeoDataFrame: The input GeoDataFrame with additional 'r', 'g', and 'b' columns.
    """
    
    gdf[["r", "g", "b"]] = gdf[key_field].apply(
        lambda key_field: pd.Series(cmap_dict.get(key_field, [255, 0, 255]))
    )
    return gdf

CMAP = {
    "sycamore maple": [255, 99, 132],
    "pignut hickory": [54, 162, 235],
    "green ash": [255, 206, 86],
    "Norway spruce": [75, 192, 192],
    "Himalayan cedar": [153, 102, 255],
    "shingle oak": [255, 159, 64],
    "American beech": [201, 203, 207],
    "pond cypress": [0, 255, 0],
    "cockspur hawthorn": [255, 0, 0],
    "cucumber magnolia": [0, 128, 0],
    "Scots pine": [255, 20, 147],
    "mimosa": [139, 0, 139],
    "pin oak": [75, 0, 130],
    "American elm": [70, 130, 180],
    "Turkish hazelnut": [240, 230, 140],
    "Atlantic white cedar": [144, 238, 144],
    "Douglas-fir": [255, 105, 180],
    "sassafras": [106, 90, 205],
    "Chinese elm": [210, 105, 30],
    "holly": [220, 20, 60],
    "white ash": [255, 255, 0],
    "tree of heaven": [255, 69, 0],
    "empress tree": [0, 0, 139],
    "Amur cork tree": [173, 255, 47],
    "dawn redwood": [46, 139, 87],
    "flowering dogwood": [255, 20, 147],
    "eastern redbud": [153, 50, 204],
    "red horse chestnut": [147, 112, 219],
    "Shantung maple": [255, 127, 80],
    "trident maple": [0, 255, 255],
    "pine": [0, 191, 255],
    "pitch pine": [255, 0, 255],
    "red maple": [0, 255, 127],
    "willow oak": [238, 130, 238],
    "Amur maple": [205, 133, 63],
    "sawtooth oak": [255, 0, 0],
    "southern magnolia": [255, 215, 0],
    "Callery pear": [0, 250, 154],
    "mulberry": [184, 134, 11],
    "spruce": [154, 205, 50],
    "cherry": [123, 104, 238],
    "Schumard's oak": [64, 224, 208],
    "Siberian elm": [255, 165, 0],
    "Kentucky coffeetree": [127, 255, 212],
    "Oklahoma redbud": [72, 61, 139],
    "boxelder": [50, 205, 50],
    "European beech": [199, 21, 133],
    "Japanese maple": [0, 0, 205],
    "smoketree": [255, 69, 0],
    "paper birch": [255, 105, 180],
    "American larch": [102, 205, 170],
    "Osage-orange": [173, 216, 230],
    "honeylocust": [0, 139, 139],
    "ash": [0, 0, 128],
    "silver maple": [255, 228, 181],
    "black cherry": [70, 130, 180],
    "sweetgum": [139, 69, 19],
    "silver linden": [205, 92, 92],
    "English oak": [255, 99, 71],
    "southern red oak": [160, 82, 45],
    "Chinese tree lilac": [139, 0, 0],
    "eastern cottonwood": [85, 107, 47],
    "bald cypress": [210, 180, 140],
    "red pine": [244, 164, 96],
    "tartar maple": [72, 209, 204],
    "Amur maackia": [105, 105, 105],
    "European hornbeam": [112, 128, 144],
    "crab apple": [0, 191, 255],
    "Norway maple": [255, 160, 122],
    "scarlet oak": [173, 255, 47],
    "Japanese zelkova": [255, 0, 255],
    "horse chestnut": [147, 112, 219],
    "littleleaf linden": [60, 179, 113],
    "white pine": [100, 149, 237],
    "Japanese tree lilac": [0, 206, 209],
    "katsura tree": [72, 61, 139],
    "black locust": [250, 128, 114],
    "Persian ironwood": [124, 252, 0],
    "Chinese chestnut": [199, 21, 133],
    "crimson king maple": [210, 105, 30],
    "arborvitae": [0, 128, 128],
    "maple": [255, 69, 0],
    "paperbark maple": [255, 99, 71],
    "European alder": [85, 107, 47],
    "Virginia pine": [144, 238, 144],
    "pagoda dogwood": [240, 128, 128],
    "hedge maple": [238, 130, 238],
    "Ohio buckeye": [50, 205, 50],
    "Kentucky yellowwood": [139, 0, 139],
    "crepe myrtle": [0, 255, 0],
    "golden raintree": [255, 20, 147],
    "weeping willow": [255, 165, 0],
    "Cornelian cherry": [255, 99, 71],
    "silver birch": [0, 255, 255],
    "'Schubert' chokecherry": [0, 0, 128],
    "catalpa": [139, 0, 0],
    "river birch": [218, 112, 214],
    "blue spruce": [75, 0, 130],
    "black pine": [72, 61, 139],
    "bur oak": [255, 69, 0],
    "ginkgo": [0, 255, 0],
    "Sophora": [255, 0, 0],
    "swamp white oak": [255, 140, 0],
    "black oak": [205, 92, 92],
    "northern red oak": [70, 130, 180],
    "blackgum": [0, 128, 128],
    "purple-leaf plum": [154, 205, 50],
    "sugar maple": [176, 224, 230],
    "Atlas cedar": [124, 252, 0],
    "serviceberry": [255, 69, 0],
    "black maple": [255, 99, 71],
    "quaking aspen": [255, 215, 0],
    "false cypress": [255, 105, 180],
    "American linden": [72, 209, 204],
    "London planetree": [50, 205, 50],
    "eastern redcedar": [123, 104, 238],
    "tulip-poplar": [0, 206, 209],
    "Chinese fringetree": [0, 191, 255],
    "white oak": [105, 105, 105],
    "hardy rubber tree": [154, 205, 50],
    "black walnut": [139, 69, 19],
    "Japanese snowbell": [255, 127, 80],
    "American hornbeam": [75, 0, 130],
    "eastern hemlock": [0, 100, 0],
    "hawthorn": [139, 0, 0],
    "magnolia": [233, 150, 122],
    "American hophornbeam": [160, 82, 45],
    "common hackberry": [0, 139, 139],
    "kousa dogwood": [0, 255, 127],
    "bigtooth aspen": [255, 140, 0],
    "two-winged silverbell": [100, 149, 237],
    "Japanese hornbeam": [70, 130, 180]
}


"""NWS Hazard Type Colormap"""
# CMAP = {
#     "sycamore maple": [34, 139, 34],
#     "pignut hickory": [255, 69, 0],
#     "green ash": [139, 0, 0],
#     "Norway spruce": [0, 100, 0],
#     "Himalayan cedar": [0, 128, 128],
#     "shingle oak": [165, 42, 42],
#     "American beech": [128, 0, 0],
#     "pond cypress": [0, 255, 127],
#     "cockspur hawthorn": [218, 165, 32],
#     "cucumber magnolia": [255, 140, 0],
#     "Scots pine": [85, 107, 47],
#     "mimosa": [154, 205, 50],
#     "pin oak": [143, 188, 143],
#     "American elm": [47, 79, 79],
#     "Turkish hazelnut": [160, 82, 45],
#     "Atlantic white cedar": [72, 61, 139],
#     "Douglas-fir": [0, 128, 0],
#     "sassafras": [173, 255, 47],
#     "Chinese elm": [124, 252, 0],
#     "holly": [34, 139, 34],
#     "white ash": [139, 69, 19],
#     "tree of heaven": [70, 130, 180],
#     "empress tree": [176, 224, 230],
#     "Amur cork tree": [32, 178, 170],
#     "dawn redwood": [222, 184, 135],
#     "flowering dogwood": [255, 105, 180],
#     "eastern redbud": [238, 130, 238],
#     "red horse chestnut": [221, 160, 221],
#     "Shantung maple": [255, 99, 71],
#     "trident maple": [255, 69, 0],
#     "pine": [34, 139, 34],
#     "pitch pine": [0, 100, 0],
#     "red maple": [255, 0, 0],
#     "willow oak": [50, 205, 50],
#     "Amur maple": [255, 20, 147],
#     "sawtooth oak": [218, 112, 214],
#     "southern magnolia": [250, 128, 114],
#     "Callery pear": [255, 215, 0],
#     "mulberry": [107, 142, 35],
#     "spruce": [46, 139, 87],
#     "cherry": [205, 92, 92],
#     "Schumard's oak": [75, 0, 130],
#     "Siberian elm": [0, 0, 255],
#     "Kentucky coffeetree": [65, 105, 225],
#     "Oklahoma redbud": [138, 43, 226],
#     "boxelder": [72, 61, 139],
#     "European beech": [75, 0, 130],
#     "Japanese maple": [153, 50, 204],
#     "smoketree": [186, 85, 211],
#     "paper birch": [147, 112, 219],
#     "American larch": [139, 0, 139],
#     "Osage-orange": [255, 0, 255],
#     "honeylocust": [238, 130, 238],
#     "ash": [255, 20, 147],
#     "silver maple": [255, 105, 180],
#     "black cherry": [139, 69, 19],
#     "sweetgum": [205, 92, 92],
#     "silver linden": [233, 150, 122],
#     "English oak": [255, 140, 0],
#     "southern red oak": [255, 127, 80],
#     "Chinese tree lilac": [255, 99, 71],
#     "eastern cottonwood": [255, 69, 0],
#     "bald cypress": [210, 105, 30],
#     "red pine": [255, 165, 0],
#     "tartar maple": [255, 215, 0],
#     "Amur maackia": [184, 134, 11],
#     "European hornbeam": [218, 165, 32],
#     "crab apple": [255, 140, 0],
#     "Norway maple": [255, 215, 0],
#     "scarlet oak": [255, 69, 0],
#     "Japanese zelkova": [255, 99, 71],
#     "horse chestnut": [255, 127, 80],
#     "littleleaf linden": [255, 140, 0],
#     "white pine": [0, 100, 0],
#     "Japanese tree lilac": [124, 252, 0],
#     "katsura tree": [0, 255, 127],
#     "black locust": [34, 139, 34],
#     "Persian ironwood": [0, 128, 128],
#     "Chinese chestnut": [210, 105, 30],
#     "crimson king maple": [255, 0, 0],
#     "arborvitae": [0, 128, 0],
#     "maple": [255, 0, 0],
#     "paperbark maple": [255, 69, 0],
#     "European alder": [34, 139, 34],
#     "Virginia pine": [0, 100, 0],
#     "pagoda dogwood": [255, 140, 0],
#     "hedge maple": [255, 215, 0],
#     "Ohio buckeye": [255, 127, 80],
#     "Kentucky yellowwood": [218, 165, 32],
#     "crepe myrtle": [255, 69, 0],
#     "golden raintree": [255, 215, 0],
#     "weeping willow": [124, 252, 0],
#     "Cornelian cherry": [255, 105, 180],
#     "silver birch": [205, 92, 92],
#     "'Schubert' chokecherry": [139, 69, 19],
#     "catalpa": [205, 133, 63],
#     "river birch": [139, 0, 0],
#     "blue spruce": [70, 130, 180],
#     "black pine": [0, 100, 0],
#     "bur oak": [85, 107, 47],
#     "ginkgo": [173, 255, 47],
#     "Sophora": [154, 205, 50],
#     "swamp white oak": [143, 188, 143],
#     "black oak": [47, 79, 79],
#     "northern red oak": [255, 0, 0],
#     "blackgum": [128, 0, 0],
#     "purple-leaf plum": [238, 130, 238],
#     "sugar maple": [255, 69, 0],
#     "Atlas cedar": [0, 128, 0],
#     "serviceberry": [176, 224, 230],
#     "black maple": [255, 0, 0],
#     "quaking aspen": [0, 128, 128],
#     "false cypress": [210, 105, 30],
#     "American linden": [255, 99, 71],
#     "London planetree": [255, 127, 80],
#     "eastern redcedar": [0, 255, 127],
#     "tulip-poplar": [34, 139, 34],
#     "Chinese fringetree": [139, 69, 19],
#     "white oak": [255, 255, 255],
#     "hardy rubber tree": [240, 230, 140],
#     "black walnut": [128, 0, 0],
#     "Japanese snowbell": [255, 105, 180],
#     "American hornbeam": [34, 139, 34],
#     "eastern hemlock": [0, 100, 0],
#     "hawthorn": [255, 0, 0],
#     "magnolia": [255, 215, 0],
#     "American hophornbeam": [139, 69, 19],
#     "common hackberry": [210, 105, 30],
#     "kousa dogwood": [255, 140, 0],
#     "bigtooth aspen": [173, 255, 47],
#     "two-winged silverbell": [154, 205, 50],
#     "Japanese hornbeam": [47, 79, 79]

# }